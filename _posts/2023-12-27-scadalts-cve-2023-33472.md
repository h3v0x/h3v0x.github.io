---
layout: post
title: Scada-LTS - Privilege escalation to RCE (CVE-2023-33472)
description: 
summary: 
tags: scada ot ics web scadalts
minute: 2
---

# Vulnerability information

- **CVE-ID**: CVE-2023-33472
- **Vulnerability Type**: Incorrect Access Control
- **Affected Product Code Base**: Scada-LTS v2.7.5.2 build 4551883606 (or previous versions)
- **Attack Type**: Remote
- **Impact**: Privilege escalation, command execution, arbitrary file read and write, information leakage and service unavailability.
- **Attack Vectors**: To exploit the vulnerability, it is required to be authenticated with a low privilege user.

## Description

A **privilege escalation** issue was discovered in *Scada-LTS v2.7.5.2 build 4551883606* allows remote attackers, authenticated in the application as a low-privileged user to perform remote code execution (RCE) through '**Event Handlers**' feature.

It was possible to identify that Scada-LTS has an administrative feature called *Event Handlers*, through which it is possible to execute actions and commands within the application server.

Knowing this point, it was identified that a low-privilege user can consume this function in an unauthorized way, thus performing command injection to exfiltrate sensitive information from the system, arbitrary read and write files on the system, escalate privileges on sytem and perform denial of service (DoS).

## Steps

First of all, it is necessary obtain a valid session by authenticating to the application with a low-privilege user account. The image below demonstrates the authentication with user 'test' (*low privilege user*):

<img src="https://github.com/hev0x/hev0x.github.io/assets/6265911/d72859e9-ea88-4377-ac94-9e3bb8604fba" style="border: 1px solid black" />

The following image confirms that the session obtained in the previous step is from a low-privilege user:

<img src="https://github.com/hev0x/hev0x.github.io/assets/6265911/bff30826-98e8-49a9-b605-dd99fe6c22df" style="border: 1px solid black" />

In turn, the following images demonstrate that through the *client-side*, it is not possible to view the **Event Handlers** page from the low-privilege user session:

<img src="https://github.com/hev0x/hev0x.github.io/assets/6265911/1cc567f1-1213-487b-8c45-aff35113dd08" style="border: 1px solid black" />
<img src="https://github.com/hev0x/hev0x.github.io/assets/6265911/2bd8823c-41b9-494d-ad5b-b3342269d134" style="border: 1px solid black" />

Knowing that, the low-privilege user's session cookie was used to perform the request responsible for testing *process commands* through the event handler function. The following image demonstrates a **command injection** to read a sensitive system file:

<img src="https://github.com/hev0x/hev0x.github.io/assets/6265911/89d6dce4-bc16-4722-826a-9df6ade5fede" style="border: 1px solid black" />

The following image demonstrates the receipt of the command performed in the previous step:

<img src="https://github.com/hev0x/hev0x.github.io/assets/6265911/36074bb3-f58a-475c-b6a8-fa7fc3b0c417" style="border: 1px solid black" />

## Conclusion

The issue has been patched in SCADA-LTS v2.7.5.3 by developers team.

**Special thanks to the Scada-LTS team for their attention and for receiving my report.**


## References

- [hhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-33472](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-33472)
- 






